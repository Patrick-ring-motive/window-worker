<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>single thread test</title>
  </head>
  <body>

    
    <script>

    main();

      async function main(){
      let wj = await fetch('./winworker.js');
      let wjs=await wj.text();
      var crf = document.createElement('iframe');
        crf.sandbox='allow-scripts';
        crf.setAttribute('sandbox','allow-scripts');
      crf.src = 'https://windowworker.github.io/worker/worker.html?'+encodeURIComponent(window.location.origin);
      document.body.appendChild(crf);
        
        
        
      window.addEventListener("message", (event) => {
          if (event.origin !== "https://windowworker.github.io")
       return;
        console.log(event.data);
      if(event.data==='ready'){
      
        crf.contentWindow.postMessage(encodeURIComponent(wjs),'https://windowworker.github.io');
      
      }
      });
      }
      
      
      
    </script>
    

  </body>
</html>
